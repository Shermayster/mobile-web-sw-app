"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),DBHelper=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"fetchRestaurants",value:function(t){return fetch(e.DATABASE_URL).then(function(e){return e.json()})["catch"](function(e){return console.log(e)})}},{key:"fetchRestaurantById",value:function(t,n){e.fetchRestaurants(function(e,a){if(e)n(e,null);else{var r=a.find(function(e){return e.id===t});r?n(null,r):n("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(t,n){e.fetchRestaurants(function(e,a){if(e)n(e,null);else{var r=a.filter(function(e){return e.cuisine_type===t});n(null,r)}})}},{key:"fetchRestaurantByNeighborhood",value:function(t,n){e.fetchRestaurants(function(e,a){if(e)n(e,null);else{var r=a.filter(function(e){return e.neighborhood===t});n(null,r)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(t,n,a){return e.fetchRestaurants().then(function(e){var a=e;return"all"!==t&&(a=a.filter(function(e){return e.cuisine_type===t})),"all"!==n&&(a=a.filter(function(e){return e.neighborhood===n})),a})}},{key:"fetchNeighborhoods",value:function(t){return e.fetchRestaurants().then(function(e){var t=e.map(function(t,n){return e[n].neighborhood}),n=t.filter(function(e,n){return t.indexOf(e)===n});return n})}},{key:"fetchCuisines",value:function(t){return e.fetchRestaurants().then(function(e){var t=e.map(function(t,n){return e[n].cuisine_type}),n=t.filter(function(e,n){return t.indexOf(e)===n});return n})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return"/img/"+e.photograph}},{key:"mapMarkerForRestaurant",value:function(t,n){var a=new google.maps.Marker({position:t.latlng,title:t.name,url:e.urlForRestaurant(t),map:n,animation:google.maps.Animation.DROP});return a}},{key:"DATABASE_URL",get:function(){var e=1337;return"http://localhost:"+e+"/restaurants"}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),map=void 0,Main=function(){function e(){_classCallCheck(this,e),this.restaurants=null,this.neighborhoods=null,this.cuisines=null,this.markers=[]}return _createClass(e,[{key:"fillCuisinesHTML",value:function(){var e=document.getElementById("cuisines-select");this.cuisines.forEach(function(t){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.append(n)})}},{key:"fetchCuisines",value:function(){var e=this;DBHelper.fetchCuisines().then(function(t){e.cuisines=t,e.fillCuisinesHTML()})}},{key:"fillNeighborhoodsHTML",value:function(){var e=document.getElementById("neighborhoods-select");this.neighborhoods.forEach(function(t){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.append(n)})}},{key:"appendRestaurantImage",value:function(e,t){var n=document.createElement("img");n.className="restaurant-img",n.src=DBHelper.imageUrlForRestaurant(e),n.alt="Restaurant: "+e.name,t.append(n)}},{key:"appendRestaurantTitle",value:function(e,t){var n=document.createElement("h3");n.innerHTML=e.name,t.append(n)}},{key:"appendRestaurantNeighborhood",value:function(e,t){var n=document.createElement("p");n.innerHTML=e.neighborhood,t.append(n)}},{key:"appendRestaurantAddress",value:function(e,t){var n=document.createElement("p");n.innerHTML=e.address,t.append(n)}},{key:"appendRestaurantDetails",value:function(e,t){var n=document.createElement("a");n.innerHTML="View Details",n.href=DBHelper.urlForRestaurant(e),t.append(n)}},{key:"addMarkersToMap",value:function(){var e=this;this.restaurants.forEach(function(t){var n=DBHelper.mapMarkerForRestaurant(t,map);google.maps.event.addListener(n,"click",function(){window.location.href=n.url}),e.markers.push(n)})}},{key:"appendRestaurantItems",value:function(e,t){this.appendRestaurantImage(e,t),this.appendRestaurantTitle(e,t),this.appendRestaurantNeighborhood(e,t),this.appendRestaurantAddress(e,t),this.appendRestaurantDetails(e,t)}},{key:"createRestaurantHTML",value:function(e){var t=document.createElement("li");return this.appendRestaurantItems(e,t),t}},{key:"fillRestaurantsHTML",value:function(){var e=this,t=document.getElementById("restaurants-list");this.restaurants.forEach(function(n){t.append(e.createRestaurantHTML(n))}),this.addMarkersToMap()}},{key:"fetchNeighborhoods",value:function(){var e=this;DBHelper.fetchNeighborhoods().then(function(t){e.neighborhoods=t,e.fillNeighborhoodsHTML()})}},{key:"resetRestaurants",value:function(e){this.restaurants=[];var t=document.getElementById("restaurants-list");t.innerHTML="",this.markers.forEach(function(e){return e.setMap(null)}),this.markers=[],this.restaurants=e}},{key:"updateRestaurants",value:function(){var e=this,t=document.getElementById("cuisines-select"),n=document.getElementById("neighborhoods-select"),a=t.selectedIndex,r=n.selectedIndex,i=t[a].value,u=n[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(i,u).then(function(t){e.resetRestaurants(t),e.fillRestaurantsHTML()})}}]),e}(),main=new Main;document.addEventListener("DOMContentLoaded",function(){main.fetchNeighborhoods(),main.fetchCuisines()}),window.initMap=function(){var e={lat:40.722216,lng:-73.987501};map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:e,scrollwheel:!1});var t=map;google.maps.event.addListener(t,"tilesloaded",function(){document.querySelectorAll("#map a").forEach(function(e){e.setAttribute("tabindex","-1")}),document.querySelectorAll("#map area").forEach(function(e){e.setAttribute("tabindex","-1")})}),main.updateRestaurants()};var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(){console.log("service worker registered!")})["catch"](function(e){console.log(e)});var RestarauntInfo=function(){function e(){_classCallCheck(this,e),this.restaurant=null}return _createClass(e,[{key:"fetchRestaurantFromURL",value:function(e){var t=this;if(this.restaurant)return void e(null,this.restaurant);var n=this.getParameterByName("id"),a=!n;if(a){var r="No restaurant id in URL";e(r,null)}else DBHelper.fetchRestaurantById(n,function(n,a){return t.restaurant=a,a?(t.fillRestaurantHTML(),void e(null,a)):void console.error(n)})}},{key:"fillRestaurantHTML",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.restaurant,t=document.getElementById("restaurant-name");t.innerHTML=e.name;var n=document.getElementById("restaurant-address");n.innerHTML=e.address;var a=document.getElementById("restaurant-img");a.className="restaurant-img",a.src=DBHelper.imageUrlForRestaurant(e),a.alt="Restaurant: "+e.name;var r=document.getElementById("restaurant-cuisine");r.innerHTML=e.cuisine_type,e.operating_hours&&this.fillRestaurantHoursHTML(),this.fillReviewsHTML()}},{key:"fillRestaurantHoursHTML",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e)if(n){var a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);var i=document.createElement("td");i.innerHTML=e[n],a.appendChild(i),t.appendChild(a)}}},{key:"fillReviewsHTML",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.restaurant.reviews,n=document.getElementById("reviews-container"),a=document.createElement("h3");if(a.innerHTML="Reviews",n.appendChild(a),!t){var r=document.createElement("p");return r.innerHTML="No reviews yet!",void n.appendChild(r)}var i=document.getElementById("reviews-list");t.forEach(function(t){i.appendChild(e.createReviewHTML(t))}),n.appendChild(i)}},{key:"createReviewHTML",value:function(e){var t=document.createElement("li"),n=document.createElement("div");n.className="review-title review-details",t.appendChild(n);var a=document.createElement("p");a.innerHTML=e.name,a.className="reviewer-name",n.appendChild(a);var r=document.createElement("p");r.innerHTML=e.date,r.className="review-date",n.appendChild(r);var i=document.createElement("div");i.className="review-content review-details",t.appendChild(i);var u=document.createElement("p");u.innerHTML="Rating: "+e.rating,u.className="review-raiting uppercase",i.appendChild(u);var o=document.createElement("p");return o.innerHTML=e.comments,i.appendChild(o),t}},{key:"fillBreadcrumb",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,n.setAttribute("aria-current","page"),t.appendChild(n)}},{key:"getParameterByName",value:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=n.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}}]),e}(),restarauntInfo=new RestarauntInfo;window.initMap=function(){restarauntInfo.fetchRestaurantFromURL(function(e,t){if(e)console.error(e);else{var n=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1});restarauntInfo.fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(restarauntInfo.restaurant,n)}})};
//# sourceMappingURL=main.min.js.map
