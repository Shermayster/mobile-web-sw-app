"use strict";var _createClass=function(){function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var networkDataReceived=!1,DBHelper=function(){function u(){_classCallCheck(this,u)}return _createClass(u,null,[{key:"GET_DATABASE_URL_MANAGE_FAVORITE",value:function(e,n){return u.BASIC_URL+"/restaurants/"+e+"/?is_favorite="+n}},{key:"fetchRestaurants",value:function(){return navigator.onLine?u._fetchRestaurants().then(function(e){return console.log("response",e),e}).catch(function(e){return console.log("restaurant from cache",e),readData("restaurants").then(function(e){return e[0]})}):readData("restaurants").then(function(e){return console.log("restaurant from cache",e),e[0]})}},{key:"getRestaurantReviews",value:function(e){return navigator.onLine?u._getRestaurantReviews(e).then(function(e){return e}).catch(function(){return readDataByKey("reviews",e)}):readDataByKey("reviews",e).then(function(e){return console.log("reviews from cache",e),e})}},{key:"addReview",value:function(e){return fetch(u.DATABASE_URL_ADD,{method:"POST",body:JSON.stringify(e)})}},{key:"deleteReview",value:function(e){return fetch(u.DATABASE_URL_DELETE_REVIEW+e,{method:"DELETE"}).then(function(e){return e.json()}).catch(function(e){return console.log(e)})}},{key:"manageFavorite",value:function(e,n){return fetch(u.GET_DATABASE_URL_MANAGE_FAVORITE(e,n),{method:"PUT"}).then(function(e){return e.json()}).catch(function(e){return console.log(e)})}},{key:"fetchRestaurantById",value:function(t,e){return u.fetchRestaurants().then(function(e){var n=e.find(function(e){return e.id==t});if(n)return n})}},{key:"fetchRestaurantByCuisine",value:function(n,e){u.fetchRestaurants.then(function(e){return e.filter(function(e){return e.cuisine_type===n})},function(e){return console.log(e)})}},{key:"fetchRestaurantByNeighborhood",value:function(n,e){u.fetchRestaurants().then(function(e){return e.filter(function(e){return e.neighborhood===n})},function(e){return console.log(e)})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(t,r,e){return u.fetchRestaurants().then(function(e){var n=e;return"all"!==t&&(n=n.filter(function(e){return e.cuisine_type===t})),"all"!==r&&(n=n.filter(function(e){return e.neighborhood===r})),n},function(e){return console.log(e)})}},{key:"fetchNeighborhoods",value:function(e){return u.fetchRestaurants().then(function(t){var r=t.map(function(e,n){return t[n].neighborhood});return r.filter(function(e,n){return r.indexOf(e)===n})},function(e){return console.log(e)})}},{key:"fetchCuisines",value:function(e){return u.fetchRestaurants().then(function(t){var r=t.map(function(e,n){return t[n].cuisine_type});return r.filter(function(e,n){return r.indexOf(e)===n})},function(e){return console.log(e)})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return{"280jpg":{url:"/images/"+e.photograph+"-280px.jpg",type:"jpg"},"280webp":{url:"/images/"+e.photograph+"-280px.webp",type:"webp"},webp:{url:"/images/"+e.photograph+"-380px.jpg",type:"webp"},jpg:{url:"/images/"+e.photograph+".jpg",type:"jpg"}}}},{key:"mapMarkerForRestaurant",value:function(e,n){return new google.maps.Marker({position:e.latlng,title:e.name,url:u.urlForRestaurant(e),map:n,animation:google.maps.Animation.DROP})}},{key:"_getRestaurantReviews",value:function(e){return fetch(u.DATABASE_URL_GET_REVIEWS+e).then(function(e){return e.json()})}},{key:"_fetchRestaurants",value:function(){return fetch(u.DATABASE_URL_GET).then(function(e){return e.json()})}},{key:"DATABASE_PORT",get:function(){return 1337}},{key:"BASIC_URL",get:function(){return"https://udacity-restaurant-review.herokuapp.com"}},{key:"DATABASE_URL_GET",get:function(){return u.BASIC_URL+"/restaurants"}},{key:"DATABASE_URL_ADD",get:function(){return u.BASIC_URL+"/reviews/"}},{key:"DATABASE_URL_GET_REVIEWS",get:function(){return u.BASIC_URL+"/reviews/?restaurant_id="}},{key:"DATABASE_URL_DELETE_REVIEW",get:function(){return u.BASIC_URL+"/reviews/"}}]),u}();